{"version":3,"file":"mini-vue.esm.js","sources":["../src/runtime-core/vnode.ts","../src/runtime-core/h.ts","../src/shared/index.ts","../src/runtime-core/component.ts","../src/runtime-core/renderer.ts","../src/runtime-core/createApp.ts"],"sourcesContent":["export function createVNode(type,props?,children?) {\r\n    return {\r\n        type,\r\n        props,\r\n        children\r\n    }\r\n}","import { createVNode } from \"./vnode\";\r\nexport const h = (type: string, props: any, children: string | Array<any>) => {\r\n  return createVNode(type, props, children);\r\n};\r\n","export const extend = Object.assign;\r\n\r\nexport const isObject = (val) => {\r\n  return val !== null && typeof val === \"object\";\r\n};\r\n\r\nexport function hasChanged(value, oldValue) {\r\n  return !Object.is(value, oldValue);\r\n}","export function createComponentInstance(vnode) {\r\n  const component = {\r\n    type: vnode.type,\r\n    vnode,\r\n  };\r\n\r\n  return component;\r\n}\r\n\r\nexport function setupComponent(instance) {\r\n  // initProps()\r\n  // initSlots()\r\n\r\n  setupStatefulComponent(instance);\r\n}\r\n\r\nfunction setupStatefulComponent(instance: any) {\r\n  // 获取到用户给到的配置\r\n  const Component = instance.type;\r\n\r\n  const { setup } = Component;\r\n  if (setup) {\r\n    // function Object\r\n\r\n    const setupResult = setup();\r\n    handleSetupResult(instance, setupResult);\r\n  }\r\n}\r\n\r\nfunction handleSetupResult(instance: any, setupResult: any) {\r\n  if (typeof setupResult === \"object\") {\r\n    instance.setupState = setupResult;\r\n  }\r\n\r\n  finishComponentSetup(instance);\r\n}\r\n\r\nfunction finishComponentSetup(instance: any) {\r\n  const Component = instance.type;\r\n  if (Component.render) {\r\n    instance.render = Component.render;\r\n  }\r\n}\r\n","import { isObject } from \"../shared\";\r\nimport { createComponentInstance, setupComponent } from \"./component\";\r\n\r\nexport function render(vnode, container) {\r\n  // path\r\n  patch(vnode, container);\r\n}\r\n\r\nfunction patch(vnode, container) {\r\n  // 判断Vnode是不是一个element\r\n  // 是element 那么 就应该处理element\r\n  // 如何判断是element类型还是component类型\r\n  // 可以通过type的类型来判断\r\n  if (typeof vnode.type === \"string\") {\r\n    processElement(vnode, container);\r\n  } else if (isObject(vnode.type)) {\r\n    processComponent(vnode, container);\r\n  }\r\n}\r\nfunction processElement(vnode: any, container: any) {\r\n  // 先初始化\r\n  mountElement(vnode, container);\r\n}\r\n\r\nfunction processComponent(vnode, container) {\r\n  mountComponent(vnode, container);\r\n}\r\n\r\nfunction mountElement(vnode: any, container: any) {\r\n  const el = document.createElement(vnode.type);\r\n  // string array\r\n  const { children } = vnode;\r\n\r\n  if (typeof children === \"string\") {\r\n    el.textContent = children;\r\n  } else if (Array.isArray(children)) {\r\n    // vnode\r\n    mountChildren(vnode, el);\r\n  }\r\n  // props\r\n  const { props } = vnode;\r\n\r\n  for (const key in props) {\r\n    const val = props[key];\r\n    el.setAttribute(key, val);\r\n  }\r\n  container.append(el);\r\n}\r\n\r\nfunction mountChildren(vnode, container) {\r\n  vnode.children.forEach((v) => {\r\n    patch(v, container);\r\n  });\r\n}\r\n\r\nfunction mountComponent(vnode: any, container) {\r\n  const instance = createComponentInstance(vnode);\r\n  setupComponent(instance);\r\n  setupRenderEffect(instance, container);\r\n}\r\n\r\nfunction setupRenderEffect(instance: any, container) {\r\n  const subTree = instance.render();\r\n\r\n  // vnode -> patch\r\n  // vnode -> element\r\n\r\n  patch(subTree, container);\r\n}\r\n","import { render } from \"./renderer\";\r\nimport { createVNode } from \"./vnode\";\r\n\r\nexport function createApp(rootComponent) {\r\n  return {\r\n    mount(rootContainer) {\r\n      // 先转换为vnode\r\n      // 所有的逻辑操作都会基于vnode做处理\r\n      const vnode = createVNode(rootComponent);\r\n\r\n      render(vnode, rootContainer);\r\n    },\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}