{"version":3,"file":"mini-vue.esm.js","sources":["../src/shared/shapeFlags.ts","../src/runtime-core/vnode.ts","../src/runtime-core/h.ts","../src/shared/index.ts","../src/reactivity/effect.ts","../src/reactivity/baseHandlers.ts","../src/reactivity/reactive.ts","../src/runtime-core/componentProps.ts","../src/runtime-core/componentPublicInstance.ts","../src/runtime-core/component.ts","../src/runtime-core/renderer.ts","../src/runtime-core/createApp.ts"],"sourcesContent":["// 组件的类型\r\nexport const enum ShapeFlags {\r\n  // 最后要渲染的 element 类型\r\n  //ELEMENT -> 0001;\r\n  // STATEFUL_COMPONENT 0010\r\n  // TEXT_CHILDREN 0100\r\n  // ARRAY_CHILDREN 1000\r\n  ELEMENT = 1, \r\n  // 组件类型\r\n  STATEFUL_COMPONENT = 1 << 1,\r\n  // vnode 的 children 为 string 类型\r\n  TEXT_CHILDREN = 1 << 2,\r\n  // vnode 的 children 为数组类型\r\n  ARRAY_CHILDREN = 1 << 3,\r\n}\r\n","import { ShapeFlags } from \"../shared/shapeFlags\";\r\n\r\nexport function createVNode(type, props?, children?) {\r\n  const vnode = {\r\n    type,\r\n    props,\r\n    children,\r\n    shapeFlag: getShapeFlag(type),\r\n    el: null,\r\n  };\r\n  // children\r\n  if (typeof children === \"string\") {\r\n    vnode.shapeFlag |= ShapeFlags.TEXT_CHILDREN;\r\n  } else if (Array.isArray(children)) {\r\n    vnode.shapeFlag |= ShapeFlags.ARRAY_CHILDREN;\r\n  }\r\n\r\n  return vnode;\r\n}\r\n\r\nfunction getShapeFlag(type: any) {\r\n  return typeof type === \"string\"\r\n    ? ShapeFlags.ELEMENT\r\n    : ShapeFlags.STATEFUL_COMPONENT;\r\n}\r\n","import { createVNode } from \"./vnode\";\r\nexport const h = (type: string, props: any, children: string | Array<any>) => {\r\n  return createVNode(type, props, children);\r\n};\r\n","export const extend = Object.assign;\r\n\r\nexport const isObject = (val) => {\r\n  return val !== null && typeof val === \"object\";\r\n};\r\n\r\nexport function hasChanged(value, oldValue) {\r\n  return !Object.is(value, oldValue);\r\n}\r\n\r\nexport const hasOwn = (val, key) => Object.prototype.hasOwnProperty.call(val, key);\r\n","import { extend } from \"../shared\";\r\nlet activeEffect;\r\nlet shouldTrack = false;\r\n\r\nexport class ReactiveEffect {\r\n  active = true;\r\n  deps = [];\r\n  onStop?: () => void;\r\n  constructor(public fn, public scheduler?) {\r\n    console.log(\"创建 ReactiveEffect 对象\");\r\n  }\r\n  run() {\r\n    console.log(\"run\");\r\n    // 运行 run 的时候，可以控制 要不要执行后续收集依赖的一步\r\n    // 目前来看的话，只要执行了 fn 那么就默认执行了收集依赖\r\n    // 这里就需要控制了\r\n\r\n    // 是不是收集依赖的变量\r\n\r\n    // 执行 fn  但是不收集依赖\r\n    if (!this.active) {\r\n      return this.fn();\r\n    }\r\n\r\n    // 执行 fn  收集依赖\r\n    // 可以开始收集依赖了\r\n    shouldTrack = true;\r\n\r\n    // 执行的时候给全局的 activeEffect 赋值\r\n    // 利用全局属性来获取当前的 effect\r\n    activeEffect = this as any;\r\n    // 执行用户传入的 fn\r\n    console.log(\"执行用户传入的 fn\");\r\n    const result = this.fn();\r\n    // 重置\r\n    shouldTrack = false;\r\n    activeEffect = undefined;\r\n\r\n    return result;\r\n  }\r\n  stop() {\r\n    if (this.active) {\r\n      // 如果第一次执行 stop 后 active 就 false 了\r\n      // 这是为了防止重复的调用，执行 stop 逻辑\r\n      cleanupEffect(this);\r\n      if (this.onStop) {\r\n        this.onStop();\r\n      }\r\n      this.active = false;\r\n    }\r\n  }\r\n}\r\n\r\nfunction cleanupEffect(effect) {\r\n  // 找到所有依赖这个 effect 的响应式对象\r\n  // 从这些响应式对象里面把 effect 给删除掉\r\n  effect.deps.forEach((dep) => {\r\n    dep.delete(effect);\r\n  });\r\n  effect.deps.length = 0;\r\n}\r\n\r\nconst targetMap = new Map();\r\n\r\nexport function track(target, key) {\r\n  if (!isTracking()) {\r\n    return;\r\n  }\r\n  console.log(`触发 track -> target: ${target} key:${key}`);\r\n  // 1. 先基于 target 找到对应的 dep\r\n  // 如果是第一次的话，那么就需要初始化\r\n  let depsMap = targetMap.get(target);\r\n\r\n  if (!depsMap) {\r\n    depsMap = new Map();\r\n    targetMap.set(target, depsMap);\r\n  }\r\n\r\n  let dep = depsMap.get(key);\r\n\r\n  if (!dep) {\r\n    dep = new Set();\r\n    depsMap.set(key, dep);\r\n  }\r\n\r\n  if (!activeEffect) return;\r\n\r\n  trackEffects(dep);\r\n}\r\n\r\nexport function trackEffects(dep) {\r\n  // 用 dep 来存放所有的 effect\r\n  if (!dep.has(activeEffect)) {\r\n    dep.add(activeEffect);\r\n    (activeEffect as any).deps.push(dep);\r\n  }\r\n}\r\n\r\nexport function trigger(target, key) {\r\n  let depsMap = targetMap.get(target);\r\n  let dep = depsMap.get(key);\r\n\r\n  triggerEffects(dep);\r\n}\r\n\r\nexport function triggerEffects(dep) {\r\n  // 执行收集到的所有的 effect 的 run 方法\r\n  for (const effect of dep) {\r\n    if (effect.scheduler) {\r\n      // scheduler 可以让用户自己选择调用的时机\r\n      effect.scheduler();\r\n    } else {\r\n      effect.run();\r\n    }\r\n  }\r\n}\r\n\r\nexport function isTracking() {\r\n  return shouldTrack && activeEffect !== undefined;\r\n}\r\n\r\nexport function effect(fn, options = {}) {\r\n  const _effect = new ReactiveEffect(fn);\r\n\r\n  // 把用户传过来的值合并到 _effect 对象上去\r\n  // 缺点就是不是显式的，看代码的时候并不知道有什么值\r\n  extend(_effect, options);\r\n  _effect.run();\r\n\r\n  // 把 _effect.run 这个方法返回\r\n  // 让用户可以自行选择调用的时机（调用 fn）\r\n  const runner: any = _effect.run.bind(_effect);\r\n  runner.effect = _effect;\r\n  return runner;\r\n}\r\n\r\nexport function stop(runner) {\r\n  runner.effect.stop();\r\n}\r\n","import { extend, isObject } from \"../shared\";\r\nimport { track, trigger } from \"./effect\";\r\nimport { ReactiveFlags, reactive, readonly } from \"./reactive\";\r\nconst get = createGetter();\r\nconst set = createSetter();\r\nconst readonlyGet = createGetter(true);\r\nconst shallowReadonlyGet = createGetter(true, true);\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n  return function get(target, key) {\r\n    const res = Reflect.get(target, key);\r\n    if (key === ReactiveFlags.IS_REACTIVE) {\r\n      return !isReadonly;\r\n    } else if (key === ReactiveFlags.IS_READONLY) {\r\n      return isReadonly;\r\n    }\r\n    if (!isReadonly) {\r\n      // 在触发 get 的时候进行依赖收集\r\n      track(target, key);\r\n    }\r\n\r\n    if (shallow) {\r\n      return res;\r\n    }\r\n\r\n    if (isObject(res)) {\r\n      // 把内部所有的是 object 的值都用 reactive 包裹，变成响应式对象\r\n      // 如果说这个 res 值是一个对象的话，那么我们需要把获取到的 res 也转换成 reactive\r\n      // res 等于 target[key]\r\n      return isReadonly ? readonly(res) : reactive(res);\r\n    }\r\n    return res;\r\n  };\r\n}\r\n\r\nfunction createSetter() {\r\n  return function set(target, key, value) {\r\n    const result = Reflect.set(target, key, value);\r\n\r\n    trigger(target, key);\r\n\r\n    return result;\r\n  };\r\n}\r\n\r\nexport const readonlyHandlers = {\r\n  get: readonlyGet,\r\n  set(target, key) {\r\n    // readonly 的响应式对象不可以修改值\r\n    console.warn(\r\n      `Set operation on key \"${String(key)}\" failed: target is readonly.`,\r\n      target\r\n    );\r\n    return true;\r\n  },\r\n};\r\n\r\nexport const mutableHandlers = {\r\n  get,\r\n  set,\r\n};\r\n\r\nexport const shallowReadonlyHandlers = extend(\r\n  {},\r\n  readonlyHandlers,\r\n  shallowReadonlyGet\r\n);","import { isObject } from \"../shared\";\r\nimport { mutableHandlers, readonlyHandlers, shallowReadonlyHandlers } from \"./baseHandlers\";\r\n\r\nexport const enum ReactiveFlags {\r\n  IS_REACTIVE = \"__v_isReactive\",\r\n  IS_READONLY = \"__v_isReadonly\",\r\n}\r\n\r\nexport function reactive(raw) {\r\n  return createReactiveObject(raw, mutableHandlers);\r\n}\r\n\r\nexport function readonly(raw) {\r\n  return createReactiveObject(raw, readonlyHandlers);\r\n}\r\nexport function shallowReadonly(raw) {\r\n  return createReactiveObject(raw, shallowReadonlyHandlers);\r\n}\r\n\r\nexport function isReadonly(value) {\r\n  return !!value[ReactiveFlags.IS_READONLY];\r\n}\r\n\r\nexport function isReactive(value) {\r\n  // 如果 value 是 proxy 的话\r\n  // 会触发 get 操作，而在 createGetter 里面会判断\r\n  // 如果 value 是普通对象的话\r\n  // 那么会返回 undefined ，那么就需要转换成布尔值\r\n  return !!value[ReactiveFlags.IS_REACTIVE];\r\n}\r\n\r\nexport function isProxy(value) {\r\n  return isReactive(value) || isReadonly(value)\r\n}\r\n\r\nfunction createReactiveObject(target, baseHandlers) {\r\n  if (!isObject(target)) {\r\n    console.warn(`target ${target} 必须是一个对象`)\r\n    return\r\n  }\r\n  return new Proxy(target, baseHandlers);\r\n}\r\n","export function initProps(instance, rawProps) {\r\n  console.log(\"initProps\");\r\n\r\n  // TODO\r\n  // 应该还有 attrs 的概念\r\n  // attrs\r\n  // 如果组件声明了 props 的话，那么才可以进入 props 属性内\r\n  // 不然的话是需要存储在 attrs 内\r\n  // 这里暂时直接赋值给 instance.props 即可\r\n  instance.props = rawProps || {};\r\n}\r\n","import { hasOwn } from \"../shared\";\r\n\r\nconst publicPropertiesMap = {\r\n  // 当用户调用 instance.proxy.$emit 时就会触发这个函数\r\n  // i 就是 instance 的缩写 也就是组件实例对象\r\n  $el: (i) => i.vnode.el,\r\n};\r\n\r\n// todo 需要让用户可以直接在 render 函数内直接使用 this 来触发 proxy\r\nexport const PublicInstanceProxyHandlers = {\r\n  get({ _: instance }, key) {\r\n    // setupState\r\n    const { setupState, props } = instance;\r\n    if (key in setupState) {\r\n      return setupState[key];\r\n    }\r\n    if (hasOwn(setupState, key)) {\r\n      return setupState[key];\r\n    } else if (hasOwn(props, key)) {\r\n      return props[key];\r\n    }\r\n\r\n    const publicGetter = publicPropertiesMap[key];\r\n\r\n    if (publicGetter) {\r\n      return publicGetter(instance);\r\n    }\r\n  },\r\n};\r\n","import { shallowReadonly } from \"../reactivity/reactive\";\r\nimport { initProps } from \"./componentProps\";\r\nimport { PublicInstanceProxyHandlers } from \"./componentPublicInstance\";\r\n\r\nexport function createComponentInstance(vnode) {\r\n  const component = {\r\n    type: vnode.type,\r\n    vnode,\r\n    setupState: {},\r\n    props: {},\r\n  };\r\n\r\n  return component;\r\n}\r\n\r\nexport function setupComponent(instance) {\r\n  initProps(instance, instance.vnode.props);\r\n  // initSlots()\r\n\r\n  setupStatefulComponent(instance);\r\n}\r\n\r\nfunction setupStatefulComponent(instance: any) {\r\n  // 获取到用户给到的配置\r\n  const Component = instance.type;\r\n  // ctx\r\n  instance.proxy = new Proxy({ _: instance }, PublicInstanceProxyHandlers);\r\n\r\n  const { setup } = Component;\r\n  if (setup) {\r\n    // function Object\r\n\r\n    const setupResult = setup(shallowReadonly(instance.props));\r\n    handleSetupResult(instance, setupResult);\r\n  }\r\n}\r\n\r\nfunction handleSetupResult(instance: any, setupResult: any) {\r\n  if (typeof setupResult === \"object\") {\r\n    instance.setupState = setupResult;\r\n  }\r\n\r\n  finishComponentSetup(instance);\r\n}\r\n\r\nfunction finishComponentSetup(instance: any) {\r\n  const Component = instance.type;\r\n  if (Component.render) {\r\n    instance.render = Component.render;\r\n  }\r\n}\r\n","import { isObject } from \"../shared\";\r\nimport { ShapeFlags } from \"../shared/shapeFlags\";\r\nimport { createComponentInstance, setupComponent } from \"./component\";\r\n\r\nexport function render(vnode, container) {\r\n  // path\r\n  patch(vnode, container);\r\n}\r\n\r\nfunction patch(vnode, container) {\r\n  // 判断Vnode是不是一个element\r\n  // 是element 那么 就应该处理element\r\n  // 如何判断是element类型还是component类型\r\n  // 可以通过type的类型来判断\r\n  const { shapeFlag } = vnode;\r\n\r\n  if (shapeFlag & ShapeFlags.ELEMENT) {\r\n    processElement(vnode, container);\r\n  } else if (shapeFlag & ShapeFlags.STATEFUL_COMPONENT) {\r\n    processComponent(vnode, container);\r\n  }\r\n}\r\nfunction processElement(vnode: any, container: any) {\r\n  // 先初始化\r\n  mountElement(vnode, container);\r\n}\r\n\r\nfunction processComponent(vnode, container) {\r\n  mountComponent(vnode, container);\r\n}\r\n\r\nfunction mountElement(vnode: any, container: any) {\r\n  const el = (vnode.el = document.createElement(vnode.type));\r\n  // string array\r\n  const { children, shapeFlag } = vnode;\r\n  if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n    el.textContent = children;\r\n  } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n    // vnode\r\n    mountChildren(vnode, el);\r\n  }\r\n  // props\r\n  const { props } = vnode;\r\n\r\n  for (const key in props) {\r\n    const val = props[key];\r\n    const isOn = (key: string) => /^on[A-Z]/.test(key);\r\n    if (isOn(key)) {\r\n      const event = key.slice(2).toLocaleLowerCase();\r\n      el.addEventListener(event, val);\r\n    } else {\r\n      el.setAttribute(key, val);\r\n    }\r\n  }\r\n  container.append(el);\r\n}\r\n\r\nfunction mountChildren(vnode, container) {\r\n  vnode.children.forEach((v) => {\r\n    patch(v, container);\r\n  });\r\n}\r\n\r\nfunction mountComponent(initialVNode: any, container) {\r\n  const instance = createComponentInstance(initialVNode);\r\n  setupComponent(instance);\r\n  setupRenderEffect(instance, initialVNode, container);\r\n}\r\n\r\nfunction setupRenderEffect(instance: any, initialVNode: any, container) {\r\n  const { proxy } = instance;\r\n  const subTree = instance.render.call(proxy);\r\n\r\n  // vnode -> patch\r\n  // vnode -> element\r\n\r\n  patch(subTree, container);\r\n\r\n  initialVNode.el = subTree.el;\r\n}\r\n","import { render } from \"./renderer\";\r\nimport { createVNode } from \"./vnode\";\r\n\r\nexport function createApp(rootComponent) {\r\n  return {\r\n    mount(rootContainer) {\r\n      // 先转换为vnode\r\n      // 所有的逻辑操作都会基于vnode做处理\r\n      const vnode = createVNode(rootComponent);\r\n\r\n      render(vnode, rootContainer);\r\n    },\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}